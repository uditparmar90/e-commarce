{% extends "base.html" %}
{% load static %}

{% block description %}{{product.description}}{% endblock %}
{% block robots %}index, follow{% endblock %}
{% block keywords %}signup, myshop{% endblock %}
{% block css %}{% static "products/signup.css" %}{% endblock %}
{% block title %}{{product.title}}{% endblock %}

{% block body %}
    
    {% include "includes/nav.html" %}
    <div id="product_main_div">
        <main style="padding:40px 200px ;  display:flex;">
            <div style=" display: flex; align-self:center;">
            <img src="{{product.image.url}}" style="border-radius: 10px;"> 
            </div> 
            
            <div style="width:40vw;background-color:lightgray; border-radius:10px;padding:10px; margin:auto;">
                <p>{{product.title}}</p>
                <p>{{product.description}}</p>
                <p>{{product.brand.title}}</p>
                <h2>{{product.price}}</h2>
                <p>{{product.}}</p>
                <button>Add to Cart</button>
            </div>
            {% comment %} <div>
                {%for suggestion in product.suggestion%}
                <h1>{{suggestion}}</h1>
                {% endfor %}
            </div> {% endcomment %}
        </main>
        <section style="margin:40px 200px; padding:15px 15px; background-color:lightgray; border-radius:10px;">
            <h3 style="font-weight:bold; margin:0px;">write your reviews</h3>
            <form action="" method="POST">
                {% csrf_token %}
                {% if success_message %}
                <div class="alert alert-success" style="color:green;">
                    {{ success_message }}
                </div>
                {% endif %}
                {% for field in form %}<br>
                {{field.label_tag}}<br>
                {{field}}<br>
                {% if field.help_text %}
                {{field.help_text}}
                {% endif %}
                {%for error in field.errors%}
                    <p style="color:red;">{{error}}</p>
                {% endfor %}<br>
                {% endfor %}
                <button type="Submit">Submit</button>
                                
            </form>
            
            <div style="width:95%; padding:20px; display: flex; flex-direction:column; background:whitesmoke;" id="ratings-div">
                <h3 style="font-weight:bold; margin:0px;">Reviews</h3>

                {% comment %} {%for data in feedbackData%}
                <span style="font-size:10px;">{{data.name}}</span>
                <span style="font-size:15px;">{{data.text}}</span>
                <span style="font-size:15px;">ratings : {{data.rating}}</span> 
                <div class="progress" style="width: 100%;
                height: 20px;
                background-color: red;
                border-radius: 4px;
                overflow: hidden;">
                <div class="progress-bar1" role="progressbar" id="progressBar" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100" style="background: orange;">showRatings({{ data.rating }})</div>                
                {%endfor%} {% endcomment %}
            <div>
            
        </section> 
        
        <script>
        var progressBars = document.getElementById("ratings-div");
var alldata = [{% for data in feedbackData %}
    {
        "name": "{{ data.name }}",
        "text": "{{ data.text }}",
        "rating": (({{ data.rating }} * 20) / {{ data.rating }}) * {{ data.rating }}
    },
{% endfor %}];


alldata.forEach(function(data) {
    var nameSpan = document.createElement("span");
    nameSpan.innerHTML ="User : "+ data.name;
    nameSpan.style.fontSize="15px";
    nameSpan.style.background="white";
    progressBars.appendChild(nameSpan);


    var textSpan = document.createElement("span");
    textSpan.innerHTML = data.text;
    progressBars.appendChild(textSpan);

    var ratingDiv = document.createElement("div");
    ratingDiv.style.background = "whitesmoke";
    ratingDiv.style.border = "2px solid gray";
    ratingDiv.style.borderRadius = "4px";
    ratingDiv.style.width = "50%"; // Adjust width as needed
    ratingDiv.style.height = "20px"; // Adjust height as needed
    ratingDiv.style.display = "flex";
    ratingDiv.style.marginBottom = "20px";
    progressBars.appendChild(ratingDiv);

    var ratingSpan = document.createElement("span");
    ratingSpan.innerHTML = data.rating +'%';
    ratingSpan.style.background = "orange";
    ratingSpan.style.borderRadius = "2px";
    ratingSpan.style.color = "white";
    ratingSpan.style.display = "block"; // Make it block to fill the parent div
    ratingSpan.style.width = data.rating + '%';
    ratingSpan.style.height = "16px";
    ratingDiv.appendChild(ratingSpan);

});
        {% comment %} var name1=document.createElement("span");
        name1.innerHTML=alldata.name;
        var text=document.createElement("span");
        var ratingspr=document.createElement("span");
        console.log(alldata)
         {% endcomment %}
            
            
        </script>
         
{% endblock %}